{"ast":null,"code":"import { authService } from './authService';\nconst API_URL = 'http://localhost';\nconst getHeaders = () => {\n  const headers = {\n    'Content-Type': 'application/json'\n  };\n  const token = authService.getToken();\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n  return headers;\n};\nconst handleResponse = async response => {\n  if (response.status === 401) {\n    // Token expired or invalid - log out\n    authService.logout();\n    window.location.reload();\n    throw new Error('Session expired. Please login again.');\n  }\n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(errorText || `HTTP ${response.status}: ${response.statusText}`);\n  }\n  return response.json();\n};\n\n// Users API\nexport const fetchUsers = async () => {\n  const response = await fetch(`${API_URL}/people`, {\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\nexport const createUser = async user => {\n  const response = await fetch(`${API_URL}/people`, {\n    method: 'POST',\n    headers: getHeaders(),\n    body: JSON.stringify(user)\n  });\n  return handleResponse(response);\n};\nexport const updateUser = async (id, user) => {\n  const response = await fetch(`${API_URL}/people/${id}`, {\n    method: 'PUT',\n    headers: getHeaders(),\n    body: JSON.stringify(user)\n  });\n  return handleResponse(response);\n};\nexport const deleteUser = async id => {\n  const response = await fetch(`${API_URL}/people/${id}`, {\n    method: 'DELETE',\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\nexport const deleteAllUsers = async () => {\n  const response = await fetch(`${API_URL}/people`, {\n    method: 'DELETE',\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\n\n// Devices API\nexport const fetchDevices = async () => {\n  const response = await fetch(`${API_URL}/devices`, {\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\nexport const createDevice = async device => {\n  const response = await fetch(`${API_URL}/devices`, {\n    method: 'POST',\n    headers: getHeaders(),\n    body: JSON.stringify(device)\n  });\n  return handleResponse(response);\n};\nexport const updateDevice = async (id, device) => {\n  const response = await fetch(`${API_URL}/devices/${id}`, {\n    method: 'PUT',\n    headers: getHeaders(),\n    body: JSON.stringify(device)\n  });\n  return handleResponse(response);\n};\nexport const updateDeviceName = async (id, name) => {\n  const response = await fetch(`${API_URL}/devices/name/${id}`, {\n    method: 'PATCH',\n    headers: getHeaders(),\n    body: JSON.stringify({\n      name\n    })\n  });\n  return handleResponse(response);\n};\nexport const updateDeviceConsumption = async (id, consumption) => {\n  const response = await fetch(`${API_URL}/devices/${id}`, {\n    method: 'PATCH',\n    headers: getHeaders(),\n    body: JSON.stringify({\n      consumption\n    })\n  });\n  return handleResponse(response);\n};\nexport const deleteAllDevices = async () => {\n  const response = await fetch(`${API_URL}/devices`, {\n    method: 'DELETE',\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\n\n// Assignments API\nexport const fetchAssignments = async () => {\n  const response = await fetch(`${API_URL}/devices/assign`, {\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\nexport const assignDeviceToUser = async (userId, deviceId) => {\n  const response = await fetch(`${API_URL}/devices/assign`, {\n    method: 'POST',\n    headers: getHeaders(),\n    body: JSON.stringify({\n      userId,\n      deviceId\n    })\n  });\n  return handleResponse(response);\n};\nexport const deleteAllAssignments = async () => {\n  const response = await fetch(`${API_URL}/devices/assign`, {\n    method: 'DELETE',\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\n\n// Keep the api object for backward compatibility\nexport const api = {\n  getUsers: fetchUsers,\n  createUser,\n  updateUser,\n  deleteUser,\n  deleteAllUsers,\n  getDevices: fetchDevices,\n  createDevice,\n  updateDevice,\n  updateDeviceName,\n  updateDeviceConsumption,\n  deleteAllDevices,\n  fetchAssignments,\n  assignDevice: assignDeviceToUser,\n  deleteAllAssignments\n};","map":{"version":3,"names":["authService","API_URL","getHeaders","headers","token","getToken","handleResponse","response","status","logout","window","location","reload","Error","ok","errorText","text","statusText","json","fetchUsers","fetch","createUser","user","method","body","JSON","stringify","updateUser","id","deleteUser","deleteAllUsers","fetchDevices","createDevice","device","updateDevice","updateDeviceName","name","updateDeviceConsumption","consumption","deleteAllDevices","fetchAssignments","assignDeviceToUser","userId","deviceId","deleteAllAssignments","api","getUsers","getDevices","assignDevice"],"sources":["P:/Cursuri/Cursuri/SD/labCode/lab/frontend/src/api.js"],"sourcesContent":["import { authService } from './authService';\r\n\r\nconst API_URL = 'http://localhost';\r\n\r\nconst getHeaders = () => {\r\n  const headers = { 'Content-Type': 'application/json' };\r\n  const token = authService.getToken();\r\n  if (token) {\r\n    headers['Authorization'] = `Bearer ${token}`;\r\n  }\r\n  return headers;\r\n};\r\n\r\nconst handleResponse = async (response) => {\r\n  if (response.status === 401) {\r\n    // Token expired or invalid - log out\r\n    authService.logout();\r\n    window.location.reload();\r\n    throw new Error('Session expired. Please login again.');\r\n  }\r\n  if (!response.ok) {\r\n    const errorText = await response.text();\r\n    throw new Error(errorText || `HTTP ${response.status}: ${response.statusText}`);\r\n  }\r\n  return response.json();\r\n};\r\n\r\n// Users API\r\nexport const fetchUsers = async () => {\r\n  const response = await fetch(`${API_URL}/people`, {\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const createUser = async (user) => {\r\n  const response = await fetch(`${API_URL}/people`, {\r\n    method: 'POST',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify(user)\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const updateUser = async (id, user) => {\r\n  const response = await fetch(`${API_URL}/people/${id}`, {\r\n    method: 'PUT',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify(user)\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const deleteUser = async (id) => {\r\n  const response = await fetch(`${API_URL}/people/${id}`, {\r\n    method: 'DELETE',\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const deleteAllUsers = async () => {\r\n  const response = await fetch(`${API_URL}/people`, {\r\n    method: 'DELETE',\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\n// Devices API\r\nexport const fetchDevices = async () => {\r\n  const response = await fetch(`${API_URL}/devices`, {\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const createDevice = async (device) => {\r\n  const response = await fetch(`${API_URL}/devices`, {\r\n    method: 'POST',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify(device)\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const updateDevice = async (id, device) => {\r\n  const response = await fetch(`${API_URL}/devices/${id}`, {\r\n    method: 'PUT',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify(device)\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const updateDeviceName = async (id, name) => {\r\n  const response = await fetch(`${API_URL}/devices/name/${id}`, {\r\n    method: 'PATCH',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify({ name })\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const updateDeviceConsumption = async (id, consumption) => {\r\n  const response = await fetch(`${API_URL}/devices/${id}`, {\r\n    method: 'PATCH',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify({ consumption })\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const deleteAllDevices = async () => {\r\n  const response = await fetch(`${API_URL}/devices`, {\r\n    method: 'DELETE',\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\n// Assignments API\r\nexport const fetchAssignments = async () => {\r\n  const response = await fetch(`${API_URL}/devices/assign`, {\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const assignDeviceToUser = async (userId, deviceId) => {\r\n  const response = await fetch(`${API_URL}/devices/assign`, {\r\n    method: 'POST',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify({ userId, deviceId })\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const deleteAllAssignments = async () => {\r\n  const response = await fetch(`${API_URL}/devices/assign`, {\r\n    method: 'DELETE',\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\n// Keep the api object for backward compatibility\r\nexport const api = {\r\n  getUsers: fetchUsers,\r\n  createUser,\r\n  updateUser,\r\n  deleteUser,\r\n  deleteAllUsers,\r\n  getDevices: fetchDevices,\r\n  createDevice,\r\n  updateDevice,\r\n  updateDeviceName,\r\n  updateDeviceConsumption,\r\n  deleteAllDevices,\r\n  fetchAssignments,\r\n  assignDevice: assignDeviceToUser,\r\n  deleteAllAssignments\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}