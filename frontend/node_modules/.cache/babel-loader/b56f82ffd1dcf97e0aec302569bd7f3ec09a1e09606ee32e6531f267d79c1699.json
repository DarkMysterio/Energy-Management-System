{"ast":null,"code":"import { authService } from './authService';\nconst API_URL = 'http://localhost';\nconst getHeaders = () => {\n  const headers = {\n    'Content-Type': 'application/json'\n  };\n  const token = authService.getToken();\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n  return headers;\n};\nconst handleResponse = async response => {\n  if (response.status === 401) {\n    // Token expired or invalid - log out\n    authService.logout();\n    window.location.reload();\n    throw new Error('Session expired. Please login again.');\n  }\n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(errorText || `HTTP ${response.status}: ${response.statusText}`);\n  }\n\n  // Handle responses with no content (204, 201, etc.)\n  if (response.status === 204 || response.status === 205) {\n    return null;\n  }\n\n  // Check if response has content\n  const contentType = response.headers.get('content-type');\n  if (contentType && contentType.includes('application/json')) {\n    const text = await response.text();\n    return text ? JSON.parse(text) : null;\n  }\n  if (response.status === 201) {\n    return null;\n  }\n\n  // Try to parse as JSON for other successful responses\n  const text = await response.text();\n  return text ? JSON.parse(text) : null;\n};\n\n// Users API\nexport const fetchUsers = async () => {\n  const response = await fetch(`${API_URL}/api/users`, {\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\nexport const createUser = async user => {\n  const response = await fetch(`${API_URL}/api/users`, {\n    method: 'POST',\n    headers: getHeaders(),\n    body: JSON.stringify(user)\n  });\n  return handleResponse(response);\n};\nexport const updateUser = async (id, user) => {\n  const response = await fetch(`${API_URL}/api/users/${id}`, {\n    method: 'PUT',\n    headers: getHeaders(),\n    body: JSON.stringify(user)\n  });\n  return handleResponse(response);\n};\nexport const deleteUser = async id => {\n  const response = await fetch(`${API_URL}/api/users/${id}`, {\n    method: 'DELETE',\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\nexport const deleteAllUsers = async () => {\n  const response = await fetch(`${API_URL}/api/users`, {\n    method: 'DELETE',\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\n\n// Devices API\nexport const fetchDevices = async () => {\n  const response = await fetch(`${API_URL}/api/devices`, {\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\nexport const createDevice = async device => {\n  const response = await fetch(`${API_URL}/api/devices`, {\n    method: 'POST',\n    headers: getHeaders(),\n    body: JSON.stringify(device)\n  });\n  return handleResponse(response);\n};\nexport const updateDevice = async (id, device) => {\n  const response = await fetch(`${API_URL}/api/devices/${id}`, {\n    method: 'PUT',\n    headers: getHeaders(),\n    body: JSON.stringify(device)\n  });\n  return handleResponse(response);\n};\nexport const updateDeviceName = async (id, name) => {\n  const response = await fetch(`${API_URL}/api/devices/name/${id}`, {\n    method: 'PATCH',\n    headers: getHeaders(),\n    body: JSON.stringify({\n      name\n    })\n  });\n  return handleResponse(response);\n};\nexport const updateDeviceConsumption = async (id, consumption) => {\n  const response = await fetch(`${API_URL}/api/devices/consumption/${id}`, {\n    method: 'PATCH',\n    headers: getHeaders(),\n    body: JSON.stringify({\n      consumption\n    })\n  });\n  return handleResponse(response);\n};\nexport const deleteAllDevices = async () => {\n  const response = await fetch(`${API_URL}/api/devices`, {\n    method: 'DELETE',\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\nexport const deleteDevice = async id => {\n  const response = await fetch(`${API_URL}/api/devices/${id}`, {\n    method: 'DELETE',\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\n\n// Assignments API\nexport const fetchAssignments = async () => {\n  const response = await fetch(`${API_URL}/api/devices/assign`, {\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\nexport const assignDeviceToUser = async (userId, deviceId) => {\n  const response = await fetch(`${API_URL}/api/devices/assign`, {\n    method: 'POST',\n    headers: getHeaders(),\n    body: JSON.stringify({\n      userID: userId,\n      deviceID: deviceId\n    })\n  });\n  return handleResponse(response);\n};\nexport const deleteAllAssignments = async () => {\n  const response = await fetch(`${API_URL}/api/devices/assign`, {\n    method: 'DELETE',\n    headers: getHeaders()\n  });\n  return handleResponse(response);\n};\n\n// Keep the api object for backward compatibility\nexport const api = {\n  getUsers: fetchUsers,\n  createUser,\n  updateUser,\n  deleteUser,\n  deleteAllUsers,\n  getDevices: fetchDevices,\n  createDevice,\n  updateDevice,\n  updateDeviceName,\n  updateDeviceConsumption,\n  deleteAllDevices,\n  fetchAssignments,\n  assignDevice: assignDeviceToUser,\n  deleteAllAssignments\n};","map":{"version":3,"names":["authService","API_URL","getHeaders","headers","token","getToken","handleResponse","response","status","logout","window","location","reload","Error","ok","errorText","text","statusText","contentType","get","includes","JSON","parse","fetchUsers","fetch","createUser","user","method","body","stringify","updateUser","id","deleteUser","deleteAllUsers","fetchDevices","createDevice","device","updateDevice","updateDeviceName","name","updateDeviceConsumption","consumption","deleteAllDevices","deleteDevice","fetchAssignments","assignDeviceToUser","userId","deviceId","userID","deviceID","deleteAllAssignments","api","getUsers","getDevices","assignDevice"],"sources":["P:/Cursuri/Cursuri/SD/labCode/lab/frontend/src/api.js"],"sourcesContent":["import { authService } from './authService';\r\n\r\nconst API_URL = 'http://localhost';\r\n\r\nconst getHeaders = () => {\r\n  const headers = { 'Content-Type': 'application/json' };\r\n  const token = authService.getToken();\r\n  if (token) {\r\n    headers['Authorization'] = `Bearer ${token}`;\r\n  }\r\n  return headers;\r\n};\r\n\r\nconst handleResponse = async (response) => {\r\n  if (response.status === 401) {\r\n    // Token expired or invalid - log out\r\n    authService.logout();\r\n    window.location.reload();\r\n    throw new Error('Session expired. Please login again.');\r\n  }\r\n  if (!response.ok) {\r\n    const errorText = await response.text();\r\n    throw new Error(errorText || `HTTP ${response.status}: ${response.statusText}`);\r\n  }\r\n  \r\n  // Handle responses with no content (204, 201, etc.)\r\n  if (response.status === 204 || response.status === 205) {\r\n    return null;\r\n  }\r\n  \r\n  // Check if response has content\r\n  const contentType = response.headers.get('content-type');\r\n  if (contentType && contentType.includes('application/json')) {\r\n    const text = await response.text();\r\n    return text ? JSON.parse(text) : null;\r\n  }\r\n  \r\n\r\n  if (response.status === 201) {\r\n    return null;\r\n  }\r\n  \r\n  // Try to parse as JSON for other successful responses\r\n  const text = await response.text();\r\n  return text ? JSON.parse(text) : null;\r\n};\r\n\r\n// Users API\r\nexport const fetchUsers = async () => {\r\n  const response = await fetch(`${API_URL}/api/users`, {\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const createUser = async (user) => {\r\n  const response = await fetch(`${API_URL}/api/users`, {\r\n    method: 'POST',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify(user)\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const updateUser = async (id, user) => {\r\n  const response = await fetch(`${API_URL}/api/users/${id}`, {\r\n    method: 'PUT',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify(user)\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const deleteUser = async (id) => {\r\n  const response = await fetch(`${API_URL}/api/users/${id}`, {\r\n    method: 'DELETE',\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const deleteAllUsers = async () => {\r\n  const response = await fetch(`${API_URL}/api/users`, {\r\n    method: 'DELETE',\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\n// Devices API\r\nexport const fetchDevices = async () => {\r\n  const response = await fetch(`${API_URL}/api/devices`, {\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const createDevice = async (device) => {\r\n  const response = await fetch(`${API_URL}/api/devices`, {\r\n    method: 'POST',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify(device)\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const updateDevice = async (id, device) => {\r\n  const response = await fetch(`${API_URL}/api/devices/${id}`, {\r\n    method: 'PUT',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify(device)\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const updateDeviceName = async (id, name) => {\r\n  const response = await fetch(`${API_URL}/api/devices/name/${id}`, {\r\n    method: 'PATCH',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify({ name })\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const updateDeviceConsumption = async (id, consumption) => {\r\n  const response = await fetch(`${API_URL}/api/devices/consumption/${id}`, {\r\n    method: 'PATCH',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify({ consumption })\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const deleteAllDevices = async () => {\r\n  const response = await fetch(`${API_URL}/api/devices`, {\r\n    method: 'DELETE',\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const deleteDevice = async (id) => {\r\n  const response = await fetch(`${API_URL}/api/devices/${id}`, {\r\n    method: 'DELETE',\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\n// Assignments API\r\nexport const fetchAssignments = async () => {\r\n  const response = await fetch(`${API_URL}/api/devices/assign`, {\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const assignDeviceToUser = async (userId, deviceId) => {\r\n  const response = await fetch(`${API_URL}/api/devices/assign`, {\r\n    method: 'POST',\r\n    headers: getHeaders(),\r\n    body: JSON.stringify({ userID: userId, deviceID: deviceId })\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\nexport const deleteAllAssignments = async () => {\r\n  const response = await fetch(`${API_URL}/api/devices/assign`, {\r\n    method: 'DELETE',\r\n    headers: getHeaders()\r\n  });\r\n  return handleResponse(response);\r\n};\r\n\r\n// Keep the api object for backward compatibility\r\nexport const api = {\r\n  getUsers: fetchUsers,\r\n  createUser,\r\n  updateUser,\r\n  deleteUser,\r\n  deleteAllUsers,\r\n  getDevices: fetchDevices,\r\n  createDevice,\r\n  updateDevice,\r\n  updateDeviceName,\r\n  updateDeviceConsumption,\r\n  deleteAllDevices,\r\n  fetchAssignments,\r\n  assignDevice: assignDeviceToUser,\r\n  deleteAllAssignments\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}